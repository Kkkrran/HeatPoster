<view class="page">
  <view class="cropper-container">
    <movable-area class="cropper-area" scale-area>
      <movable-view
        class="cropper-view"
        direction="all"
        scale
        scale-min="0.5"
        scale-max="5"
        scale-value="{{scale}}"
        x="{{x}}"
        y="{{y}}"
        bindchange="onChange"
        bindscale="onScale"
        style="width: {{imgWidth}}px; height: {{imgHeight}}px;"
      >
        <image
          src="{{src}}"
          class="cropper-image"
          style="width: 100%; height: 100%; transform: rotate({{rotate}}deg);"
        ></image>
      </movable-view>
    </movable-area>

    <!-- 遮罩层，中间镂空显示裁剪区域 -->
    <view class="mask" pointer-events="none">
      <view class="mask-top"></view>
      <view class="mask-middle">
        <view class="mask-left"></view>
        <view class="crop-box" style="width: {{cropWidth}}px; height: {{cropHeight}}px;"></view>
        <view class="mask-right"></view>
      </view>
      <view class="mask-bottom"></view>
    </view>
  </view>

  <view class="footer">
    <view class="btn-group">
      <t-button theme="light" size="large" bindtap="onRotate">旋转 90°</t-button>
      <t-button theme="primary" size="large" bindtap="onConfirm">确认使用</t-button>
    </view>
  </view>

  <!-- 用于生成图片的 Canvas -->
  <canvas type="2d" id="cropCanvas" class="crop-canvas" style="width: {{cropWidth}}px; height: {{cropHeight}}px; position: absolute; left: -9999px;"></canvas>
</view>
