<view class="page">
  <view class="cropper-container">
    <movable-area class="cropper-area" scale-area>
      <movable-view
        class="cropper-view"
        direction="none"
        scale
        scale-min="0.5"
        scale-max="5"
        scale-value="{{scale}}"
        x="{{x}}"
        y="{{y}}"
        bindchange="onChange"
        bindscale="onScale"
        style="width: {{imgWidth}}px; height: {{imgHeight}}px;"
      >
        <image
          src="{{src}}"
          class="cropper-image"
          style="width: 100%; height: 100%; transform: rotate({{rotate}}deg);"
        ></image>
      </movable-view>
    </movable-area>

    <!-- 取景框层，覆盖在图片之上 -->
    <movable-area class="crop-box-area" pointer-events="none">
      <movable-view
        class="crop-box-view"
        direction="all"
        x="{{cropX}}"
        y="{{cropY}}"
        bindchange="onCropChange"
        style="width: {{cropWidth}}px; height: {{cropHeight}}px;"
        pointer-events="auto"
      >
        <view class="crop-box-inner"></view>
      </movable-view>
    </movable-area>
  </view>

  <view class="footer">
    <view class="btn-group">
      <t-button theme="light" size="large" bindtap="onRotate">旋转 90°</t-button>
      <t-button theme="primary" size="large" bindtap="onConfirm">确认使用</t-button>
    </view>
  </view>

  <!-- 用于生成图片的 Canvas -->
  <canvas type="2d" id="cropCanvas" class="crop-canvas" style="width: {{cropWidth}}px; height: {{cropHeight}}px; position: absolute; left: -9999px;"></canvas>
</view>
