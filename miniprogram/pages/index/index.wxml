<!-- 作品库页（TDesign Weixin） -->
<view class="page">
  <view class="header">
    <view>
      <view class="title">作品库</view>
      <view class="subtitle">热力图绘画 · 本地保存</view>
    </view>
    <view class="header-actions">
      <t-button theme="light" size="medium" icon="refresh" bind:tap="refresh" style="margin-right: 16rpx;"></t-button>
      <t-button theme="primary" size="medium" bind:tap="onCreate">新建</t-button>
    </view>
  </view>

  <view class="tip-card">
    <view class="tip-title">小提示</view>
    <view class="tip-text">按住画布越久颜色越暖；支持多级撤回与重做。</view>
    <view class="tip-tag">
      <t-tag theme="primary" variant="light">MVP</t-tag>
    </view>
  </view>

  <scroll-view class="list" scroll-y>
    <block wx:if="{{artworks.length === 0}}">
      <view class="empty-wrap">
        <t-empty description="暂无作品，点击右上角新建" />
      </view>
    </block>

    <t-cell-group wx:else>
      <t-cell wx:for="{{artworks}}" wx:key="id" title="{{item.name}}" description="更新：{{item.updatedAtText}}" arrow bind:tap="onOpen" data-id="{{item.id}}">
        <view slot="leftIcon">
          <t-avatar size="medium" shape="round" image="{{item.thumbnail}}" />
        </view>
        <view slot="note" class="cell-note">
          <!-- WXML 不支持 bind:tap.stop；用 catchtap 阻止事件冒泡 -->
          <t-button size="small" variant="outline" theme="default" catchtap="onMore" data-id="{{item.id}}">⋯</t-button>
        </view>
      </t-cell>
    </t-cell-group>

    <view class="footer-space"></view>
  </scroll-view>

  <view class="bottom-bar">
    <t-button variant="outline" theme="default" block bind:tap="onGoSettings">设置</t-button>
  </view>

  <t-action-sheet 
    visible="{{moreVisible}}" 
    items="{{moreItems}}" 
    show-cancel
    bind:close="onCloseMore" 
    bind:cancel="onCloseMore"
    bind:selected="onMoreSelect" 
  />
</view>
